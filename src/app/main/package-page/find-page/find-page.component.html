<ng-container *ngIf="isExec">
  <div id="loader" style="position: absolute;z-index: 1000;background: rgb(255 255 255 / 50%);left: 0em;" class="container w-100 h-100 d-flex align-items-center justify-content-center">
    <!-- <img width="8%" src="../../../assets/image/loader.gif" alt=""> -->
    <ion-spinner mode="ios" name="dots"></ion-spinner>
  </div>
</ng-container>
<ion-header class="ion-no-border">
  <ion-toolbar style="--background:white;">
    <!-- <ion-back-button slot="start" style="color: #ffb400;" text="" icon="chevron-back-outline"></ion-back-button> -->
    <ion-button (click)="onback()" mode="ios" fill="clear">
      <ion-icon style="color: #ffb400;" name="chevron-back-outline"></ion-icon>
    </ion-button>
    <ion-title mode="ios">Tìm kiếm kiện ký gửi</ion-title>
  </ion-toolbar>
  <ion-toolbar style="--background:white;color: #ffb400;">
    <ion-searchbar animated="true" (ionChange)="ionChange($event)" (ionClear)="ionChange($event)" placeholder="Nhập mã kiện hàng" enterkeyhint="search" mode="ios" class="pt-0" show-clear-button="always"></ion-searchbar>
  </ion-toolbar>
</ion-header>
<ion-content>
  <div *ngIf="isEmpty" style="flex-direction: column;" class="d-flex align-items-center h-100 justify-content-center">
    <img style="width: 20%;" src="../../../../assets/image/find.png" alt="">
    <div class="text-center mt-2">
      <ion-text color="medium">
        Bạn có thể tìm kiếm theo ID kiện hàng
      </ion-text>
    </div>
  </div>
  <ng-container *ngIf="lstData && lstData.length">
    <ion-list>
      <ng-container *ngFor="let item of lstData; trackBy: trackByFn">
        <ion-item lines="none" style="border-bottom: 1px solid #f2f2f2;padding-top: 1em;">
          <ion-card class="w-100" style="margin: 0em;box-shadow: none" mode="ios">
            <ion-card-header style="padding: 0.2em;">
              <div style="justify-content: space-between;" class="d-flex align-items-center">
                <div>
                  <ion-text style="font-size: 1.2em;" class="font-weight-bold me-2">
                    Mã kiện hàng
                  </ion-text>
                </div>
                <div class="d-flex align-items-center">
                  <ion-text class="me-2" style="font-size: 1.2em;">
                    {{item.packageCode}}
                  </ion-text>
                  <ion-icon [cdkCopyToClipboard]="item.packageCode" style="font-size: 1.5rem;" name="copy-outline"></ion-icon>
                </div>
              </div>
            </ion-card-header>
            <ion-card-content style="padding: 0.2em;">
              <div class="d-flex align-items-center">
                <ng-container *ngIf="item.status == 0 || item.status == 1">
                  <img  style="width: 4em;height: 4em;
                  margin-right: 1rem;" src="../../../assets/image/package-wait.png" alt="">
                </ng-container>
                <ng-container *ngIf="item.status == 2 || item.status == 3 || item.status == 4">
                  <img  style="width: 4em;height: 4em;
                  margin-right: 1rem;" src="../../../assets/image/package-delivery.png" alt="">
                </ng-container>
                <ng-container *ngIf="item.status == 5">
                  <img  style="width: 4em;height: 4em;
                  margin-right: 1rem;" src="../../../assets/image/package.png" alt="">
                </ng-container>
                <ng-container *ngIf="item.status == 9 || item.status == 10 || item.status == 11">
                  <img  style="width: 4em;height: 4em;
                  margin-right: 1rem;" src="../../../assets/image/package-cancelled.png" alt="">
                </ng-container>
                <div>
                  <ion-text mode="ios">
                    <span> Loại vận chuyển:</span>
                    <ng-container [ngSwitch]="item.movingMethod">
                      <span *ngSwitchCase="2">
                        Chậm
                      </span>
                      <span *ngSwitchCase="3">
                        Bộ
                      </span>
                      <span *ngSwitchCase="4">
                        Bộ lô
                      </span>
                      <span *ngSwitchCase="5">
                        Biển
                      </span>
                      <span *ngSwitchDefault>
                        Nhanh
                      </span>
                    </ng-container>
                  </ion-text>
                  <br>
                  <ion-text>
                    <span>Kho nhận:</span>
                    <ng-container [ngSwitch]="item.wareHouse">
                      <span *ngSwitchCase="'1'">
                        Đông quản
                      </span>
                      <span *ngSwitchCase="'2'">
                        Phật sơn
                      </span>
                    </ng-container>
                    </ion-text>
                  <br>
                  <ion-text>
                    <span>Ngày tạo: </span>
                    <span>{{item.createdDate | date : 'dd/MM/yyyy hh:mm a'}}</span>
                  </ion-text>
                  <br>
                  <ion-text>
                    <span>Dịch vụ phụ: </span>
                    <span *ngIf="item.isWoodPackage">Đóng gỗ</span>
                    <span *ngIf="item.isAirPackage">;Bọt khí</span>
                    <span *ngIf="item.isInsurance">;Bảo hiểm</span>
                    <span *ngIf="!item.isWoodPackage && !item.isAirPackage && !item.isInsurance">Không có</span>
                  </ion-text>
                </div>
              </div>
              <div class="d-flex justify-content-end">
                <span class="badge badge-pill badge-dark">
                  <ng-container [ngSwitch]="item.status">
                    <span *ngSwitchCase="2">
                      Hàng về kho TQ
                    </span>
                    <span *ngSwitchCase="3">
                      Đang về HCM
                    </span>
                    <span *ngSwitchCase="4">
                      Hàng về tới HCM
                    </span>
                    <span *ngSwitchCase="5">
                      Đã nhận hàng
                    </span>
                    <span *ngSwitchCase="9">
                      Đã hủy
                    </span>
                    <span *ngSwitchCase="10">
                      Thất lạc
                    </span>
                    <span *ngSwitchCase="11">
                      Không nhận được hàng
                    </span>
                    <span *ngSwitchDefault>
                      Chưa xác nhận
                    </span>
                  </ng-container>
                </span>
              </div>
              <div class="text-center d-flex justify-content-end pt-3 pb-3">
                <button (click)="viewDetail(item)" style="background-color: #ffc107;border: none !important;border-radius: 1em;" type="button" class="btn btn-primary btn-sm text-white">
                  <div class="d-flex align-items-center justify-content-center">
                    <i class="bi bi-eye me-2"></i>
                    <span>Xem chi tiết</span>
                  </div>
                </button>
                <ng-container *ngIf="item.status < 2">
                  <button style="border-radius: 1em;" (click)="checkStatus(item)" type="button" class="btn btn-secondary btn-sm text-white ml-3">
                    <div class="d-flex align-items-center justify-content-center">
                      <i class="bi bi-check2-circle me-2"></i>
                      <span>Kiểm tra hàng</span>
                    </div>
                  </button>
                  <button style="border-radius: 1em;" (click)="cancelPackage(item)" type="button" class="btn btn-danger btn-sm text-white ml-3">
                    <div class="d-flex align-items-center justify-content-center">
                      <i class="bi bi-x-octagon me-2"></i>
                      <span>Hủy đơn</span>
                    </div>
                  </button>
                </ng-container>
              </div> 
            </ion-card-content>
          </ion-card>
        </ion-item>
      </ng-container>
    </ion-list>
  </ng-container>
</ion-content>